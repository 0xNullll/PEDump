# PEdump Project TODO List

[x] = finished
[-] = work in progress
[ ] = not finished


====================================================
## PE HEADERS & STRUCTURE PARSING (PARSING ONLY)
====================================================

# --- TOP-LEVEL HEADERS ---
- [x] Parse DOS Header (IMAGE_DOS_HEADER)
- [x] Parse DOS Stub
- [x] Parse PE Signature ("PE\0\0")
- [x] Parse File Header (IMAGE_FILE_HEADER)

# --- OPTIONAL HEADERS ---
- [x] Parse Optional Header 32-bit (IMAGE_OPTIONAL_HEADER32)
- [x] Parse Optional Header 64-bit (IMAGE_OPTIONAL_HEADER64)

# --- SECTION TABLE ---
- [x] Parse Section Table (IMAGE_SECTION_HEADER)
- [x] Parse section names
- [x] Parse section metadata (VA, raw size, virtual size, characteristics)

# --- DIRECTORY PARSING (ALL 16 STANDARD DATA DIRECTORIES) ---

1. EXPORT DIRECTORY
- [x] Parse IMAGE_EXPORT_DIRECTORY
- [x] Parse export names, ordinals, and function RVAs

2. IMPORT DIRECTORY
- [x] Parse IMAGE_IMPORT_DESCRIPTOR
- [x] Parse INT/IAT tables (thunks)
- [x] Parse imported module names and function names

3. RESOURCE DIRECTORY
- [x] Parse IMAGE_RESOURCE_DIRECTORY
- [x] Parse resource directory entries
- [x] Parse resource data entries

4. EXCEPTION DIRECTORY
- [x] Parse RuntimeFunction entries (unwind info)

5. CERTIFICATE DIRECTORY
- [x] Parse WIN_CERTIFICATE table (raw extraction)

6. BASE RELOCATION DIRECTORY
- [x] Parse relocation blocks
- [x] Parse relocation entries

7. DEBUG DIRECTORY
- [x] Parse IMAGE_DEBUG_DIRECTORY
- [x] Parse CodeView / PDB info
- [x] Parse MISC and OMAP debug info

8. ARCHITECTURE DIRECTORY
- [ ] Parse architecture-specific directory (rare)

9. TLS DIRECTORY
- [x] Parse IMAGE_TLS_DIRECTORY32
- [x] Parse IMAGE_TLS_DIRECTORY64

10. LOAD CONFIG DIRECTORY
- [x] Parse IMAGE_LOAD_CONFIG_DIRECTORY32
- [x] Parse IMAGE_LOAD_CONFIG_DIRECTORY64
- [x] Parse Guard CF metadata
- [ ] Parse Enclave information
- [ ] Parse Hotpatch / SEH tables

11. BOUND IMPORT DIRECTORY
- [x] Parse bound import descriptors

12. IAT DIRECTORY
- [x] Parse the IAT table (raw entries)

13. DELAY-LOAD IMPORT DIRECTORY
- [x] Parse IMAGE_DELAYLOAD_DESCRIPTOR
- [x] Parse delayed thunks

14. CLR DIRECTORY (.NET)
- [x] Parse IMAGE_COR20_HEADER
- [ ] Parse metadata directory
- [ ] Parse CLR data streams



====================================================
## CORE FEATURES
====================================================
- [x] Overlay parser
- [x] String Parser
- [x] Extraction of data
- [x] Hexdump annotations with section markers
- [ ] Packer detection heuristics ### only in v2
- [x] Split format options into temporary (-tf / --temp-format) and permanent (-f / --format)
- [x] Add the ability to decide max and start offset using hex or lines
- [ ] Add a "raw dump" feature (strip all annotations)
- [x] Implement basic RVA -> file offset converter
- [x] Implement file offset -> RVA converter



====================================================
## CERTIFICATES & SECURITY
====================================================
- [ ] Parse security certificates in dump_reloc_dir (OpenSSL)
- [ ] Parse catalog certificates in dump_load_config_dir (OpenSSL)
- [ ] Add signature verification (Authenticode chain)



====================================================
## SPECIAL PE STRUCTURES
====================================================
- [ ] Parse & dump IMAGE_ENCLAVE_CONFIG32 & IMAGE_ENCLAVE_CONFIG64
- [ ] Finish parsing/dumping CLR/.NET information ### only in v2



====================================================
## RESOURCES & METADATA
====================================================
- [x] Make a dumping function for version info



====================================================
## DEBUGGING & TESTING
====================================================
- [ ] Test dump_MISC_debug_info
- [ ] Test dump_exception_debug_info
- [ ] Test dump_OMAP_debug_info
- [ ] Test dump_bound_import_dir
- [x] Fix all possible warnings
- [ ] Test commands system in many ways to clear errors
- [-] Test on Linux
- [ ] Test on macOS
- [-] Run tests for memory leaks and bad memory access



====================================================
## FRAMEWORK & USABILITY
====================================================
- [x] Print high-level file overview (sizes, section counts, memory vs disk)
- [x] Update dump_all_data_directories to handle formats + RVA conversions
- [x] Allow raw dump line ranges (-1, start-end, default all)
- [x] Dump all printable strings with metadata
- [x] Implement search (string/regex) with offsets + format support
- [x] Implement hashing feature (all SHA2/SHA512 variants + MD5 + SHA1)
- [-] Extend -H / Hash comparison to accept multiple files/sections
- [-] Extend -cc / compare to accept multiple files



====================================================
## CLEANUP & POLISH
====================================================
- [-] Polish functions
- [-] Add/update header file comments
- [x] Round number inputs to prevent errors
- [x] Update flags function names to start with Get*
- [x] Update all header files (IN, OUT, INOUT prefixes)



====================================================
## MALFORMED FILE HANDLING
====================================================
- [x] Implement malformed-file error system

- [x] Invalid DOS magic -> ERR_INVALID_DOS
- [x] e_lfanew beyond file size -> no EOF reading
- [x] Missing/corrupt PE signature -> ERR_NO_PE_SIG
- [x] Empty section table -> no crash
- [x] Section with zero SizeOfRawData -> safe
- [ ] Section overlapping VA/PointerToRawData -> error or skip
- [x] Section PointerToRawData > file size -> error
- [x] RVA outside all sections -> return -1
- [x] Data directory RVA=0 Size=0 -> handled
- [x] Truncated resource directory -> detected
- [ ] Resource with bad NameOffset/ID -> skip safely
- [ ] CLR header with invalid metadata RVA -> error
- [ ] Malformed RuntimeFunctionEntry -> skip
- [x] Packed section (VirtualSize=0 but data exists) -> safe
- [x] Non-printable section name -> handled
- [x] Overlay after last section -> detected
- [ ] Bit-flipped headers -> safe skip
- [ ] File truncated mid-section -> detect
- [ ] Duplicate sections -> warn or skip